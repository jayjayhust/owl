// Code generated by godddx, DO AVOID EDIT.
package recordingdb

import (
	"context"

	"github.com/gowvp/owl/internal/core/recording"
	"github.com/ixugo/goddd/pkg/orm"
	"gorm.io/gorm"
)

var _ recording.RecordingStorer = Recording{}

// Recording Related business namespaces
type Recording DB

// NewRecording instance object
func NewRecording(db *gorm.DB) Recording {
	return Recording{db: db}
}

// Find implements recording.RecordingStorer.
func (d Recording) Find(ctx context.Context, bs *[]*recording.Recording, page orm.Pager, opts ...orm.QueryOption) (int64, error) {
	return orm.FindWithContext(ctx, d.db, bs, page, opts...)
}

// Get implements recording.RecordingStorer.
func (d Recording) Get(ctx context.Context, model *recording.Recording, opts ...orm.QueryOption) error {
	return orm.FirstWithContext(ctx, d.db, model, opts...)
}

// Add implements recording.RecordingStorer.
func (d Recording) Add(ctx context.Context, model *recording.Recording) error {
	return d.db.WithContext(ctx).Create(model).Error
}

// Edit implements recording.RecordingStorer.
func (d Recording) Edit(ctx context.Context, model *recording.Recording, changeFn func(*recording.Recording), opts ...orm.QueryOption) error {
	return orm.UpdateWithContext(ctx, d.db, model, changeFn, opts...)
}

// Del implements recording.RecordingStorer.
func (d Recording) Del(ctx context.Context, model *recording.Recording, opts ...orm.QueryOption) error {
	return orm.DeleteWithContext(ctx, d.db, model, opts...)
}

// Count implements recording.RecordingStorer.
func (d Recording) Count(ctx context.Context, opts ...orm.QueryOption) (int64, error) {
	return orm.CountWithContext[recording.Recording](ctx, d.db, opts...)
}

// Session 事务组合
func (d Recording) Session(ctx context.Context, changeFns ...func(*gorm.DB) error) error {
	return d.db.WithContext(ctx).Transaction(func(tx *gorm.DB) error {
		for _, fn := range changeFns {
			if err := fn(tx); err != nil {
				return err
			}
		}
		return nil
	})
}

// EditWithSession 修改事务
func (d Recording) EditWithSession(tx *gorm.DB, model *recording.Recording, changeFn func(b *recording.Recording) error, opts ...orm.QueryOption) error {
	return orm.UpdateWithSession(tx, model, changeFn, opts...)
}
